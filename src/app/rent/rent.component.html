 
<app-loader [isLoading]="pageLoading"></app-loader>


<div class="container py-4">
  <h3>Available Properties on Rent</h3> <br>
<!--   <form>
    <div class="mb-3">
      <label for="propertyType" class="form-label">Property Type</label>
      <select class="form-select" id="propertyType">
        <option>Apartment</option>
        <option>Villa</option>
        <option>Independent House</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="rentRange" class="form-label">Rent Range</label>
      <input type="text" class="form-control" id="rentRange" placeholder="Enter rent range">
    </div>
    <div class="mb-3">
      <label for="location" class="form-label">Location</label>
      <input type="text" class="form-control" id="location" placeholder="Enter location">
    </div>
    <button class="btn btn-primary">Search</button>
  </form> -->


   
    <div
  class="scroll-container"
  infiniteScroll
  [infiniteScrollDistance]="2"
  [infiniteScrollThrottle]="300"
  (scrolled)="onScroll()"
>
 
  <div class="row g-3" *ngIf="propertiesList.length; else loading">
      <div class="col-12 col-md-4" *ngFor="let property of propertiesList">
        <div class="card h-100 shadow-sm">
          <div class="card-body plist">
              <p class="card-text">  <strong> Posted By : </strong>{{ property.postedBy }}</p>
             <p class="card-text"> <strong>BHK :</strong>{{ property.bhkType }}</p>
              <p class="card-text">  <strong> City : </strong>{{ property.localityCity || 'Not Available' }}</p>
               <p class="card-text">  <strong> Apartment : </strong>{{ property.apartmentName }}</p>
               <p class="card-text">  <strong> Availability Status : </strong>{{ property.availabilityStatus }}</p>
               <p class="card-text">  <strong> Posted Date : </strong>{{ property.propertyPostedDate }}</p>
               <p class="card-text">  <strong> Available For :</strong>{{ property.propertyAdsType }}</p>
                <p class="card-text">  <strong> Deposite : </strong>{{ property.expectedDeposit | currency:'INR'}}</p>
              <p class="card-text">  <strong>Available From : </strong>{{ property.availableFrom }}</p>
               <p class="card-text">  <strong> Furnishing :</strong>{{ property.furnishing }}</p>
               <p class="card-text"> <strong> Type : </strong>{{property.propertyType }}</p>
              <p class="card-text fw-bold">Expected Rent: {{ property.expectedRent | currency:'INR' }}</p>

                                 
            <button type="button" class="btn btn-secondary seemore" data-bs-toggle="modal" data-bs-target="#detailsModal" (click)="getSelectedProperty(property)">
              Show Details
            </button> &nbsp;&nbsp;&nbsp;
               <button class="btn btn-success" (click)="sendWhatsAppInterest(property)">Contact via WhatsApp</button>

          </div>

        </div>

      </div>

      

    </div>

     <div *ngIf="propertiesList.length > 0; else noData">

     </div>
<ng-template #noData>
  <div class="text-center text-danger mt-4">
    No data found
  </div>
</ng-template>
    <ng-template #loading >
      <p>Loading properties...</p>
     </ng-template>
</div>

</div>
 
<div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Property Full Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body" *ngIf="currentSelectedProperty">

        <!-- Basic Info -->
        <h5 class="text-primary">Posted By</h5>
        <ul class="list-group mb-3">
          <li class="list-group-item"><strong>Name:</strong> {{ currentSelectedProperty.name }}</li>
           <li class="list-group-item"><strong>Date Posted:</strong> {{ currentSelectedProperty.propertyPostedDate }}</li>
          <li class="list-group-item"><strong>Posted By:</strong> {{ currentSelectedProperty.postedBy }}</li>
          <li class="list-group-item"><strong>Property Type:</strong> {{ currentSelectedProperty.propertyType }}</li>
          <li class="list-group-item"><strong>Available For:</strong> {{ currentSelectedProperty.propertyAdsType }}</li>
        </ul>

        <!-- Property Details -->
        <h5 class="text-primary">Property Details</h5>
        <ul class="list-group mb-3">
          <li class="list-group-item"><strong>Apartment Type:</strong> {{ currentSelectedProperty.apartmentType }}</li>
          <li class="list-group-item"><strong>BHK:</strong> {{ currentSelectedProperty.bhkType }}</li>
          <li class="list-group-item"><strong>Total Floor:</strong> {{ currentSelectedProperty.totalFloor }}</li>
          <li class="list-group-item"><strong>Property On Floor:</strong> {{ currentSelectedProperty.floor }}</li>
          <li class="list-group-item"><strong>Facing:</strong> {{ currentSelectedProperty.facing }}</li>
          <li class="list-group-item"><strong>Apartment Name:</strong> {{ currentSelectedProperty.apartmentName }}</li>
          <li class="list-group-item"><strong>Property Age:</strong> {{ currentSelectedProperty.propertyAge }}</li>
          <li class="list-group-item"><strong>Built Up Area:</strong> {{ currentSelectedProperty.builtUpArea }} SQFT</li>
          <li class="list-group-item"><strong>Property Status:</strong> {{ currentSelectedProperty.propertyStatus }}</li>
          <li class="list-group-item"><strong>Availability Status:</strong> {{ currentSelectedProperty.availabilityStatus }}</li>
          <li class="list-group-item"><strong>Purpose Status:</strong> {{ currentSelectedProperty.purposeStatus }}</li>
        </ul>

        <!-- Locality Details -->
        <h5 class="text-primary">Locality Details</h5>
        <ul class="list-group mb-3">
          <li class="list-group-item"><strong>City:</strong> {{ currentSelectedProperty.localityCity}}</li>
          <li class="list-group-item"><strong>Locality:</strong> {{ currentSelectedProperty.locality }}</li>
          <li class="list-group-item"><strong>Landmark Street:</strong> {{ currentSelectedProperty.landmark }}</li>
        </ul>

        <!-- Rental Details -->
        <h5 class="text-primary">Rental Details</h5>
        <ul class="list-group mb-3">
           <li class="list-group-item"><strong>Expected Rent:</strong> {{ currentSelectedProperty.expectedRent }}</li>
          <li class="list-group-item"><strong>Expected Deposit:</strong> {{ currentSelectedProperty.expectedDeposit }}</li>
          <li class="list-group-item"><strong>Rent Negotiable:</strong> {{ currentSelectedProperty.rentNegotiable ? 'Yes' : 'No' }}</li>
          <li class="list-group-item"><strong>Monthly Maintenance:</strong> {{ currentSelectedProperty.monthlyMaintenance }}</li>
          <li class="list-group-item"><strong>Maintenance Amount:</strong> {{ currentSelectedProperty.maintenanceAmount }}</li>
          <li class="list-group-item"><strong>Available From:</strong> {{ currentSelectedProperty.availableFrom }}</li>
          <li class="list-group-item"><strong>Furnishing Status:</strong> {{ currentSelectedProperty.furnishing }}</li>
          <li class="list-group-item"><strong>Parking:</strong> {{ currentSelectedProperty.parking }}</li>
          <li class="list-group-item"><strong>Preferred Tenants:</strong> {{ currentSelectedProperty.preferredTenants }}</li>
          <li class="list-group-item"><strong>Description:</strong> {{ currentSelectedProperty.description }}</li>
        </ul>

        <!-- Amenities -->
        <h5 class="text-primary">Amenities</h5>
        <ul class="list-group mb-3">
          <li class="list-group-item"><strong>Available Amenities:</strong> {{ currentSelectedProperty.availableAmenities }}</li>
          <li class="list-group-item"><strong>Bathroom:</strong> {{ currentSelectedProperty.bathroom }}</li>
          <li class="list-group-item"><strong>Balcony:</strong> {{ currentSelectedProperty.balcony }}</li>
          <li class="list-group-item"><strong>Water Supply:</strong> {{ currentSelectedProperty.waterSupply }}</li>
          <li class="list-group-item"><strong>Gym:</strong> {{ currentSelectedProperty.gym ? 'Yes' : 'No' }}</li>
          <li class="list-group-item"><strong>Non Veg Allowed:</strong> {{ currentSelectedProperty.nonvegAllowed ? 'Yes' : 'No' }}</li>
          <li class="list-group-item"><strong>Gate Security:</strong> {{ currentSelectedProperty.gateSecurity ? 'Yes' : 'No' }}</li>
          <li class="list-group-item"><strong>Who Will Show Property:</strong> {{ currentSelectedProperty.whoWillShowProperty }}</li>
          <li class="list-group-item"><strong>Property Condition:</strong> {{ currentSelectedProperty.currentPropertyCondition }}</li>
         </ul>

        <!-- Schedule -->
        <h5 class="text-primary">Visit Schedule</h5>
        <ul class="list-group mb-3">
          <li class="list-group-item"><strong>Owner Availability:</strong> {{ currentSelectedProperty.ownerAvailability }}</li>
          <li class="list-group-item"><strong>From Time:</strong> {{ formatTimeToDate(currentSelectedProperty.fromTime) | date:'hh:mm a' }}</li>
          <li class="list-group-item"><strong>To Time:</strong> {{ formatTimeToDate(currentSelectedProperty.toTime) | date:'hh:mm a' }}</li>
        </ul>

        <!-- Gallery -->
        <h5 class="text-primary">Gallery</h5>
        <div class="d-flex flex-wrap gap-3 justify-content-start">
          <img *ngIf="currentSelectedProperty.propertyPhotos1" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos1" class="img-thumbnail" width="400" height="400" />
          <img *ngIf="currentSelectedProperty.propertyPhotos2" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos2" class="img-thumbnail" width="400" height="400" />
          <img *ngIf="currentSelectedProperty.propertyPhotos3" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos3" class="img-thumbnail" width="400" height="400" />
          <img *ngIf="currentSelectedProperty.propertyPhotos4" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos4" class="img-thumbnail" width="400" height="400" />
          <img *ngIf="currentSelectedProperty.propertyPhotos5" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos5" class="img-thumbnail" width="400" height="400" />
          <img *ngIf="currentSelectedProperty.propertyPhotos6" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos6" class="img-thumbnail" width="400" height="400" />
          <img *ngIf="currentSelectedProperty.propertyPhotos7" [src]="'data:image/jpeg;base64,' + currentSelectedProperty.propertyPhotos7" class="img-thumbnail" width="400" height="400" />
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
